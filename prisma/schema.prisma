generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x", "windows"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model activofisico {
  id_activo              Int               @id @default(autoincrement())
  codigo_activo          String            @unique @db.VarChar(50)
  id_estructura          Int
  id_produccion          Int
  numero_serie           String?           @unique @db.VarChar(100)
  estado_fisico          String?           @default("Disponible") @db.VarChar(20)
  fecha_fabricacion      DateTime          @db.Date
  ubicacion_almacen      String?           @db.VarChar(100)
  ajuste_precio_venta    Decimal?          @db.Decimal(10, 2)
  ajuste_precio_alquiler Decimal?          @db.Decimal(10, 2)
  motivo_ajuste          String?
  fecha_ajuste           DateTime?         @db.Timestamp(6)
  id_usuario_ajusto      Int?
  observaciones          String?
  estructuramodular      estructuramodular @relation(fields: [id_estructura], references: [id_estructura], onDelete: NoAction, onUpdate: NoAction)
  produccion             produccion        @relation(fields: [id_produccion], references: [id_produccion], onDelete: NoAction, onUpdate: NoAction)
  usuario                usuario?          @relation(fields: [id_usuario_ajusto], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction)
  activoimagen           activoimagen[]
  certificacion          certificacion[]
  detallealquiler        detallealquiler[]
  detalleventa           detalleventa[]
  mantenimiento          mantenimiento[]

  @@index([codigo_activo], map: "idx_activo_codigo")
  @@index([estado_fisico], map: "idx_activo_estado")
  @@index([id_estructura], map: "idx_activo_estructura")
  @@index([id_produccion], map: "idx_activo_produccion")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model activoimagen {
  id_imagen    Int          @id @default(autoincrement())
  id_activo    Int
  url_imagen   String
  descripcion  String?      @db.VarChar(200)
  es_principal Boolean?     @default(false)
  orden        Int?         @default(0)
  fecha_subida DateTime?    @default(now()) @db.Timestamp(6)
  activofisico activofisico @relation(fields: [id_activo], references: [id_activo], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_activo], map: "idx_img_activo")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model alquiler {
  id_alquiler           Int                @id @default(autoincrement())
  codigo_alquiler       String             @unique @db.VarChar(50)
  id_cliente            Int
  id_responsable        Int
  fecha_alquiler        DateTime?          @default(now()) @db.Timestamp(6)
  fecha_inicio_alquiler DateTime           @db.Date
  fecha_fin_alquiler    DateTime           @db.Date
  periodos_3dias        Int
  subtotal_alquiler     Decimal            @db.Decimal(12, 2)
  subtotal_servicios    Decimal?           @default(0) @db.Decimal(12, 2)
  total_alquiler        Decimal            @db.Decimal(12, 2)
  metodo_pago           String             @db.VarChar(50)
  estado_pago           String?            @default("Pagado") @db.VarChar(20)
  ciudad_evento         String             @db.VarChar(100)
  direccion_evento      String
  distancia_km          Decimal?           @db.Decimal(8, 2)
  estado_alquiler       String?            @default("Activo") @db.VarChar(20)
  observaciones         String?
  cliente               cliente            @relation(fields: [id_cliente], references: [id_cliente], onDelete: NoAction, onUpdate: NoAction)
  personal              personal           @relation(fields: [id_responsable], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)
  detallealquiler       detallealquiler[]
  devolucion            devolucion?
  servicioalquiler      servicioalquiler[]

  @@index([id_cliente], map: "idx_alq_cliente")
  @@index([codigo_alquiler], map: "idx_alq_codigo")
  @@index([estado_alquiler], map: "idx_alq_estado")
  @@index([fecha_inicio_alquiler], map: "idx_alq_inicio")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model cargo {
  id_cargo         Int            @id @default(autoincrement())
  nombre           String         @unique @db.VarChar(100)
  descripcion      String?
  nivel_jerarquico Int?
  salario_base     Decimal?       @db.Decimal(10, 2)
  fecha_creacion   DateTime?      @default(now()) @db.Timestamp(6)
  cargopermiso     cargopermiso[]
  personal         personal[]

  @@index([nombre], map: "idx_cargo_nombre")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model cargopermiso {
  id_cargo_permiso Int       @id @default(autoincrement())
  id_cargo         Int
  id_permiso       Int
  fecha_asignacion DateTime? @default(now()) @db.Timestamp(6)
  cargo            cargo     @relation(fields: [id_cargo], references: [id_cargo], onDelete: NoAction, onUpdate: NoAction)
  permiso          permiso   @relation(fields: [id_permiso], references: [id_permiso], onDelete: NoAction, onUpdate: NoAction)

  @@unique([id_cargo, id_permiso])
  @@index([id_cargo], map: "idx_cp_cargo")
  @@index([id_permiso], map: "idx_cp_permiso")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model certificacion {
  id_certificacion      Int          @id @default(autoincrement())
  id_activo             Int
  tipo_certificacion    String       @db.VarChar(100)
  numero_certificado    String?      @unique @db.VarChar(100)
  entidad_certificadora String       @db.VarChar(200)
  fecha_emision         DateTime     @db.Date
  fecha_vencimiento     DateTime     @db.Date
  documento_url         String?
  estado                String?      @default("Vigente") @db.VarChar(20)
  activofisico          activofisico @relation(fields: [id_activo], references: [id_activo], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_activo], map: "idx_cert_activo")
  @@index([estado], map: "idx_cert_estado")
  @@index([fecha_vencimiento], map: "idx_cert_vencimiento")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model cliente {
  id_cliente      Int        @id @default(autoincrement())
  tipo_cliente    String     @db.VarChar(20)
  nit_ci          String     @unique @db.VarChar(20)
  nombre_completo String     @db.VarChar(200)
  razon_social    String?    @db.VarChar(200)
  email           String     @db.VarChar(100)
  telefono        String     @db.VarChar(20)
  direccion       String
  ciudad          String     @db.VarChar(100)
  fecha_registro  DateTime?  @default(now()) @db.Timestamp(6)
  estado          String?    @default("Activo") @db.VarChar(20)
  alquiler        alquiler[]
  venta           venta[]

  @@index([email], map: "idx_cliente_email")
  @@index([estado], map: "idx_cliente_estado")
  @@index([nit_ci], map: "idx_cliente_nit")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model configuraciontemporada {
  id_config_temporada Int       @id @default(autoincrement())
  mes                 Int
  id_temporada        Int
  anio                Int
  activo              Boolean?  @default(true)
  temporada           temporada @relation(fields: [id_temporada], references: [id_temporada], onDelete: NoAction, onUpdate: NoAction)

  @@unique([mes, anio])
  @@index([id_temporada], map: "idx_config_temp")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model configuraciontransporte {
  id_config_transporte Int       @id @default(autoincrement())
  nombre               String    @db.VarChar(100)
  descripcion          String?
  km_gratis            Int       @default(0)
  precio_por_km        Decimal   @db.Decimal(8, 2)
  activo               Boolean?  @default(true)
  fecha_creacion       DateTime? @default(now()) @db.Timestamp(6)
  fecha_modificacion   DateTime? @default(now()) @db.Timestamp(6)
  id_usuario_modifico  Int
  usuario              usuario   @relation(fields: [id_usuario_modifico], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction)

  @@index([activo], map: "idx_config_trans_activo")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model detallealquiler {
  id_detalle_alquiler    Int          @id @default(autoincrement())
  id_alquiler            Int
  id_activo              Int
  precio_3dias           Decimal      @db.Decimal(10, 2)
  id_temporada_aplicada  Int?
  multiplicador_aplicado Decimal?     @db.Decimal(5, 2)
  periodos_3dias         Int
  subtotal               Decimal      @db.Decimal(12, 2)
  activofisico           activofisico @relation(fields: [id_activo], references: [id_activo], onDelete: NoAction, onUpdate: NoAction)
  alquiler               alquiler     @relation(fields: [id_alquiler], references: [id_alquiler], onDelete: NoAction, onUpdate: NoAction)
  temporada              temporada?   @relation(fields: [id_temporada_aplicada], references: [id_temporada], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_activo], map: "idx_da_activo")
  @@index([id_alquiler], map: "idx_da_alquiler")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model detalleventa {
  id_detalle_venta       Int          @id @default(autoincrement())
  id_venta               Int
  id_activo              Int
  precio_unitario        Decimal      @db.Decimal(10, 2)
  id_temporada_aplicada  Int?
  multiplicador_aplicado Decimal?     @db.Decimal(5, 2)
  cantidad               Int          @default(1)
  subtotal               Decimal      @db.Decimal(12, 2)
  activofisico           activofisico @relation(fields: [id_activo], references: [id_activo], onDelete: NoAction, onUpdate: NoAction)
  temporada              temporada?   @relation(fields: [id_temporada_aplicada], references: [id_temporada], onDelete: NoAction, onUpdate: NoAction)
  venta                  venta        @relation(fields: [id_venta], references: [id_venta], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_activo], map: "idx_dv_activo")
  @@index([id_venta], map: "idx_dv_venta")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model devolucion {
  id_devolucion            Int      @id @default(autoincrement())
  id_alquiler              Int      @unique
  fecha_devolucion_real    DateTime @db.Date
  fecha_devolucion_pactada DateTime @db.Date
  dias_retraso             Int      @default(0)
  periodos_mora            Int      @default(0)
  monto_mora               Decimal? @default(0) @db.Decimal(10, 2)
  estado_estructuras       String?
  id_receptor              Int
  observaciones            String?
  alquiler                 alquiler @relation(fields: [id_alquiler], references: [id_alquiler], onDelete: NoAction, onUpdate: NoAction)
  personal                 personal @relation(fields: [id_receptor], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_alquiler], map: "idx_dev_alquiler")
  @@index([fecha_devolucion_real], map: "idx_dev_fecha")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model estructuramodular {
  id_estructura              Int            @id @default(autoincrement())
  codigo                     String         @unique @db.VarChar(50)
  nombre                     String         @db.VarChar(200)
  tipo_evento                String         @db.VarChar(100)
  descripcion_tecnica        String
  capacidad_personas         Int?
  capacidad_peso_kg          Decimal?       @db.Decimal(10, 2)
  dimensiones_largo          Decimal?       @db.Decimal(8, 2)
  dimensiones_ancho          Decimal?       @db.Decimal(8, 2)
  dimensiones_alto           Decimal?       @db.Decimal(8, 2)
  materiales                 String?
  tiempo_montaje_horas       Int?
  personal_requerido_montaje Int?
  precio_base_venta          Decimal        @db.Decimal(10, 2)
  precio_base_alquiler_3dias Decimal        @db.Decimal(10, 2)
  id_ingeniero_diseno        Int
  fecha_diseno               DateTime       @db.Date
  plano_tecnico_url          String?
  estado                     String?        @default("Activo") @db.VarChar(20)
  activofisico               activofisico[]
  personal                   personal       @relation(fields: [id_ingeniero_diseno], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)
  produccion                 produccion[]

  @@index([codigo], map: "idx_estructura_codigo")
  @@index([id_ingeniero_diseno], map: "idx_estructura_ingeniero")
  @@index([tipo_evento], map: "idx_estructura_tipo")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model mantenimiento {
  id_mantenimiento    Int          @id @default(autoincrement())
  id_activo           Int
  tipo_mantenimiento  String       @db.VarChar(50)
  fecha_inicio        DateTime     @db.Date
  fecha_fin           DateTime?    @db.Date
  descripcion_trabajo String
  costo               Decimal?     @db.Decimal(10, 2)
  id_responsable      Int
  estado              String?      @default("Pendiente") @db.VarChar(20)
  activofisico        activofisico @relation(fields: [id_activo], references: [id_activo], onDelete: NoAction, onUpdate: NoAction)
  personal            personal     @relation(fields: [id_responsable], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_activo], map: "idx_mant_activo")
  @@index([estado], map: "idx_mant_estado")
  @@index([id_responsable], map: "idx_mant_responsable")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model multiplicadortemporada {
  id_multiplicador Int       @id @default(autoincrement())
  id_temporada     Int
  tipo_operacion   Int
  multiplicador    Decimal   @db.Decimal(5, 2)
  fecha_inicio     DateTime  @db.Date
  fecha_fin        DateTime? @db.Date
  activo           Boolean?  @default(true)
  temporada        temporada @relation(fields: [id_temporada], references: [id_temporada], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_temporada, tipo_operacion, activo], map: "idx_mult_temp_tipo")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model permiso {
  id_permiso   Int            @id @default(autoincrement())
  codigo       String         @unique @db.VarChar(50)
  nombre       String         @db.VarChar(100)
  descripcion  String?
  modulo       String         @db.VarChar(50)
  cargopermiso cargopermiso[]

  @@index([codigo], map: "idx_permiso_codigo")
  @@index([modulo], map: "idx_permiso_modulo")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model personal {
  id_personal        Int                  @id @default(autoincrement())
  ci                 String               @unique @db.VarChar(20)
  nombre             String               @db.VarChar(100)
  apellido           String               @db.VarChar(100)
  email              String?              @unique @db.VarChar(100)
  telefono           String?              @db.VarChar(20)
  direccion          String?
  id_cargo           Int
  fecha_contratacion DateTime             @db.Date
  estado             String?              @default("Activo") @db.VarChar(20)
  alquiler           alquiler[]
  devolucion         devolucion[]
  estructuramodular  estructuramodular[]
  mantenimiento      mantenimiento[]
  cargo              cargo                @relation(fields: [id_cargo], references: [id_cargo], onDelete: NoAction, onUpdate: NoAction)
  produccion         produccion[]
  produccionpersonal produccionpersonal[]
  usuario            usuario?
  venta              venta[]

  @@index([id_cargo], map: "idx_personal_cargo")
  @@index([ci], map: "idx_personal_ci")
  @@index([nombre, apellido], map: "idx_personal_nombre")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model produccion {
  id_produccion          Int                  @id @default(autoincrement())
  codigo_produccion      String               @unique @db.VarChar(50)
  id_estructura          Int
  cantidad_producir      Int
  id_supervisor          Int
  fecha_inicio           DateTime             @db.Date
  fecha_fin_estimada     DateTime             @db.Date
  fecha_fin_real         DateTime?            @db.Date
  costo_total_produccion Decimal?             @db.Decimal(12, 2)
  estado                 String?              @default("En Proceso") @db.VarChar(20)
  observaciones          String?
  activofisico           activofisico[]
  estructuramodular      estructuramodular    @relation(fields: [id_estructura], references: [id_estructura], onDelete: NoAction, onUpdate: NoAction)
  personal               personal             @relation(fields: [id_supervisor], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)
  produccionpersonal     produccionpersonal[]

  @@index([codigo_produccion], map: "idx_prod_codigo")
  @@index([estado], map: "idx_prod_estado")
  @@index([id_estructura], map: "idx_prod_estructura")
  @@index([id_supervisor], map: "idx_prod_supervisor")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model produccionpersonal {
  id_produccion_personal Int        @id @default(autoincrement())
  id_produccion          Int
  id_personal            Int
  rol_en_produccion      String     @db.VarChar(100)
  fecha_asignacion       DateTime   @db.Date
  fecha_fin              DateTime?  @db.Date
  horas_trabajadas       Decimal?   @db.Decimal(8, 2)
  personal               personal   @relation(fields: [id_personal], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)
  produccion             produccion @relation(fields: [id_produccion], references: [id_produccion], onDelete: NoAction, onUpdate: NoAction)

  @@unique([id_produccion, id_personal])
  @@index([id_personal], map: "idx_pp_personal")
  @@index([id_produccion], map: "idx_pp_produccion")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model servicioadicional {
  id_servicio      Int                @id @default(autoincrement())
  id_tipo_servicio Int
  nombre           String             @db.VarChar(200)
  descripcion      String?
  precio_base      Decimal            @db.Decimal(10, 2)
  disponible       Boolean?           @default(true)
  tiposervicio     tiposervicio       @relation(fields: [id_tipo_servicio], references: [id_tipo_servicio], onDelete: NoAction, onUpdate: NoAction)
  servicioalquiler servicioalquiler[]
  servicioventa    servicioventa[]

  @@index([disponible], map: "idx_serv_disponible")
  @@index([id_tipo_servicio], map: "idx_serv_tipo")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model servicioalquiler {
  id_servicio_alquiler Int               @id @default(autoincrement())
  id_alquiler          Int
  id_servicio          Int
  cantidad             Int               @default(1)
  precio_unitario      Decimal           @db.Decimal(10, 2)
  subtotal             Decimal           @db.Decimal(10, 2)
  alquiler             alquiler          @relation(fields: [id_alquiler], references: [id_alquiler], onDelete: NoAction, onUpdate: NoAction)
  servicioadicional    servicioadicional @relation(fields: [id_servicio], references: [id_servicio], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_alquiler], map: "idx_sa_alquiler")
  @@index([id_servicio], map: "idx_sa_servicio")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model servicioventa {
  id_servicio_venta Int               @id @default(autoincrement())
  id_venta          Int
  id_servicio       Int
  cantidad          Int               @default(1)
  precio_unitario   Decimal           @db.Decimal(10, 2)
  subtotal          Decimal           @db.Decimal(10, 2)
  servicioadicional servicioadicional @relation(fields: [id_servicio], references: [id_servicio], onDelete: NoAction, onUpdate: NoAction)
  venta             venta             @relation(fields: [id_venta], references: [id_venta], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_servicio], map: "idx_sv_servicio")
  @@index([id_venta], map: "idx_sv_venta")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sesionlogin {
  id_sesion        Int       @id @default(autoincrement())
  id_usuario       Int
  token_jwt        String
  ip_address       String?   @db.VarChar(45)
  user_agent       String?
  fecha_inicio     DateTime? @default(now()) @db.Timestamp(6)
  fecha_expiracion DateTime  @db.Timestamp(6)
  activa           Boolean?  @default(true)
  usuario          usuario   @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction)

  @@index([activa], map: "idx_sesion_activa")
  @@index([id_usuario], map: "idx_sesion_usuario")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model temporada {
  id_temporada           Int                      @id @default(autoincrement())
  nombre                 String                   @unique @db.VarChar(50)
  descripcion            String?
  color_hex              String?                  @db.VarChar(7)
  configuraciontemporada configuraciontemporada[]
  detallealquiler        detallealquiler[]
  detalleventa           detalleventa[]
  multiplicadortemporada multiplicadortemporada[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model tiposervicio {
  id_tipo_servicio  Int                 @id @default(autoincrement())
  nombre            String              @unique @db.VarChar(100)
  descripcion       String?
  servicioadicional servicioadicional[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model usuario {
  id_usuario              Int                       @id @default(autoincrement())
  uuid                    String                    @unique @db.VarChar(36)
  id_personal             Int                       @unique
  username                String                    @unique @db.VarChar(50)
  password_hash           String                    @db.VarChar(255)
  ultimo_acceso           DateTime?                 @db.Timestamp(6)
  intentos_fallidos       Int?                      @default(0)
  bloqueado               Boolean?                  @default(false)
  fecha_creacion          DateTime?                 @default(now()) @db.Timestamp(6)
  activofisico            activofisico[]
  configuraciontransporte configuraciontransporte[]
  sesionlogin             sesionlogin[]
  personal                personal                  @relation(fields: [id_personal], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_personal], map: "idx_usuario_personal")
  @@index([username], map: "idx_usuario_username")
  @@index([uuid], map: "idx_usuario_uuid")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model venta {
  id_venta             Int             @id @default(autoincrement())
  codigo_venta         String          @unique @db.VarChar(50)
  id_cliente           Int
  id_vendedor          Int
  fecha_venta          DateTime?       @default(now()) @db.Timestamp(6)
  subtotal_estructuras Decimal         @db.Decimal(12, 2)
  subtotal_servicios   Decimal?        @default(0) @db.Decimal(12, 2)
  total_venta          Decimal         @db.Decimal(12, 2)
  metodo_pago          String          @db.VarChar(50)
  estado_pago          String?         @default("Pagado") @db.VarChar(20)
  ciudad_destino       String?         @db.VarChar(100)
  direccion_destino    String?
  distancia_km         Decimal?        @db.Decimal(8, 2)
  observaciones        String?
  detalleventa         detalleventa[]
  servicioventa        servicioventa[]
  cliente              cliente         @relation(fields: [id_cliente], references: [id_cliente], onDelete: NoAction, onUpdate: NoAction)
  personal             personal        @relation(fields: [id_vendedor], references: [id_personal], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_cliente], map: "idx_venta_cliente")
  @@index([codigo_venta], map: "idx_venta_codigo")
  @@index([fecha_venta], map: "idx_venta_fecha")
  @@index([id_vendedor], map: "idx_venta_vendedor")
}
